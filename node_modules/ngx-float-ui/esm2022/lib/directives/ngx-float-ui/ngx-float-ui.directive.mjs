import { Directive, EventEmitter, Inject, Input, Output } from "@angular/core";
//
import { fromEvent, Subject, takeUntil, timer } from "rxjs";
import { NgxFloatUiContentComponent } from "../../components/ngx-float-ui-content/ngx-float-ui-content.component";
import { NGX_FLOAT_UI_DEFAULTS } from "../../models/ngx-float-ui-defaults.model";
import { NgxFloatUiTriggers } from "../../models/ngx-float-ui-triggers.model";
import { NgxFloatUiUtils } from "../../models/ngx-float-ui-utils.class";
import * as i0 from "@angular/core";
export class NgxFloatUiDirective {
    _changeDetectorRef;
    _elementRef;
    _vcr;
    _popperDefaults;
    static baseOptions = {
        showDelay: 0,
        hideOnClickOutside: true,
        hideOnMouseLeave: false,
        hideOnScroll: false,
        appendTo: undefined,
        ariaRole: "popper",
        ariaDescribe: "",
        styles: {},
        trigger: NgxFloatUiTriggers.click
    };
    set applyClass(newValue) {
        if (newValue === this._applyClass) {
            return;
        }
        this._applyClass = newValue;
        this._checkExisting("applyClass", newValue);
    }
    get applyClass() {
        return this._applyClass;
    }
    set arrowClass(newValue) {
        if (newValue === this._arrowClass) {
            return;
        }
        this._arrowClass = newValue;
        if (this._content) {
            this._content.floatUiOptions.applyArrowClass = newValue;
            if (!this._shown) {
                return;
            }
            this._content.update();
        }
    }
    get arrowClass() {
        return this._arrowClass;
    }
    set disabled(newValue) {
        if (newValue === this._disabled) {
            return;
        }
        this._disabled = !!newValue;
        if (this._shown) {
            this.hide();
        }
    }
    get disabled() {
        return this._disabled;
    }
    set floatUi(newValue) {
        if (newValue === this._floatUi) {
            return;
        }
        this._floatUi = newValue;
        if (this._content) {
            if (typeof newValue === "string") {
                this._content.text = newValue;
            }
            else {
                this._content = newValue;
            }
        }
    }
    get floatUi() {
        return this._floatUi;
    }
    set hideOnClickOutside(newValue) {
        this._hideOnClickOutside = NgxFloatUiUtils.coerceBooleanProperty(newValue);
    }
    get hideOnClickOutside() {
        return this._hideOnClickOutside;
    }
    set placement(newValue) {
        this._placement = newValue;
        this._checkExisting("placement", newValue);
    }
    get placement() {
        return this._placement;
    }
    set preventOverflow(newValue) {
        this._preventOverflow = NgxFloatUiUtils.coerceBooleanProperty(newValue);
        this._checkExisting("preventOverflow", this._preventOverflow);
    }
    get preventOverflow() {
        return this._preventOverflow;
    }
    set showOnStart(newValue) {
        this._showOnStart = NgxFloatUiUtils.coerceBooleanProperty(newValue);
    }
    get showOnStart() {
        return this._showOnStart;
    }
    appendTo;
    ariaDescribe;
    ariaRole;
    boundariesElement;
    disableAnimation;
    disableStyle;
    hideOnMouseLeave;
    hideOnScroll;
    hideTimeout = 0;
    onHidden = new EventEmitter();
    onShown = new EventEmitter();
    onUpdate = new EventEmitter();
    positionFixed;
    showDelay;
    showTrigger;
    styles;
    targetElement;
    timeoutAfterShow = 0;
    _applyClass;
    _arrowClass;
    _content;
    _contentClass = NgxFloatUiContentComponent;
    _contentRef;
    _destroy$ = new Subject();
    _disabled;
    _floatUi;
    _globalEventListenersCtrl$ = new Subject();
    _hideOnClickOutside = !0;
    _placement;
    _preventOverflow;
    _scheduledHideTimeoutCtrl$ = new Subject();
    _scheduledShowTimeoutCtrl$ = new Subject();
    _shown = !1;
    _showOnStart = !1;
    constructor(_changeDetectorRef, _elementRef, _vcr, _popperDefaults = {}) {
        this._changeDetectorRef = _changeDetectorRef;
        this._elementRef = _elementRef;
        this._vcr = _vcr;
        this._popperDefaults = _popperDefaults;
        NgxFloatUiDirective.baseOptions = { ...NgxFloatUiDirective.baseOptions, ...this._popperDefaults };
    }
    static assignDefined(target, ...sources) {
        for (const source of sources) {
            for (const key of Object.keys(source)) {
                const val = source[key];
                if (val !== undefined) {
                    target[key] = val;
                }
            }
        }
        return target;
    }
    applyTriggerListeners() {
        switch (this.showTrigger) {
            case NgxFloatUiTriggers.click:
                this._addListener("click", this.toggle.bind(this));
                break;
            case NgxFloatUiTriggers.mousedown:
                this._addListener("mousedown", this.toggle.bind(this));
                break;
            case NgxFloatUiTriggers.hover:
                this._addListener("mouseenter", this.scheduledShow.bind(this, this.showDelay));
                ["touchend", "touchcancel", "mouseleave"].forEach((eventName) => {
                    this._addListener(eventName, this.scheduledHide.bind(this, null, this.hideTimeout));
                });
                break;
        }
        if (this.showTrigger !== NgxFloatUiTriggers.hover && this.hideOnMouseLeave) {
            ["touchend", "touchcancel", "mouseleave"].forEach((eventName) => {
                this._addListener(eventName, this.scheduledHide.bind(this, null, this.hideTimeout));
            });
        }
    }
    getRefElement() {
        return this.targetElement || this._elementRef.nativeElement;
    }
    hide() {
        if (this.disabled) {
            return;
        }
        if (!this._shown) {
            this._scheduledShowTimeoutCtrl$.next();
            return;
        }
        this._shown = false;
        if (this._contentRef) {
            this._contentRef.instance.hide();
        }
        else {
            this._content.hide();
        }
        this.onHidden.emit(this);
        this._globalEventListenersCtrl$.next();
    }
    hideOnClickOutsideHandler($event) {
        if (this.disabled || !this.hideOnClickOutside || $event.target === this._content.elRef.nativeElement ||
            this._content.elRef.nativeElement.contains($event.target)) {
            return;
        }
        this.scheduledHide($event, this.hideTimeout);
    }
    hideOnScrollHandler($event) {
        if (this.disabled || !this.hideOnScroll) {
            return;
        }
        this.scheduledHide($event, this.hideTimeout);
    }
    ngOnDestroy() {
        this._destroy$.next();
        this._destroy$.complete();
        this._content && this._content.clean();
    }
    ngOnInit() {
        if (typeof this.floatUi === "string") {
            this._content = this._constructContent();
            this._content.text = this.floatUi;
        }
        else if (typeof this.floatUi === typeof void 0) {
            this._content = this._constructContent();
            this._content.text = "";
        }
        else {
            this._content = this.floatUi;
        }
        const popperRef = this._content;
        popperRef.referenceObject = this.getRefElement();
        this._setContentProperties(popperRef);
        this._setDefaults();
        this.applyTriggerListeners();
        if (this.showOnStart) {
            this.scheduledShow();
        }
    }
    scheduledHide($event = null, delay = this.hideTimeout) {
        if (this.disabled) {
            return;
        }
        this._scheduledHideTimeoutCtrl$.next();
        timer(delay)
            .pipe(takeUntil(this._scheduledHideTimeoutCtrl$), takeUntil(this._destroy$))
            .subscribe({
            next: () => {
                // TODO: check
                const toElement = $event ? $event.toElement : null;
                const popperContentView = this._content.floatUiViewRef ? this._content.floatUiViewRef.nativeElement : false;
                if (!popperContentView ||
                    popperContentView === toElement ||
                    popperContentView.contains(toElement) ||
                    (this.floatUi && this.floatUi.isMouseOver)) {
                    return;
                }
                this.hide();
                this._applyChanges();
            }
        });
    }
    scheduledShow(delay = this.showDelay) {
        if (this.disabled) {
            return;
        }
        this._scheduledHideTimeoutCtrl$.next();
        timer(delay)
            .pipe(takeUntil(this._scheduledShowTimeoutCtrl$), takeUntil(this._destroy$))
            .subscribe({
            next: () => {
                this.show();
                this._applyChanges();
            }
        });
    }
    show() {
        if (this._shown) {
            this._scheduledHideTimeoutCtrl$.next();
            return;
        }
        this._shown = true;
        const popperRef = this._content;
        const element = this.getRefElement();
        if (popperRef.referenceObject !== element) {
            popperRef.referenceObject = element;
        }
        this._setContentProperties(popperRef);
        popperRef.show();
        this.onShown.emit(this);
        if (this.timeoutAfterShow > 0) {
            this.scheduledHide(null, this.timeoutAfterShow);
        }
        fromEvent(document, "click")
            .pipe(takeUntil(this._globalEventListenersCtrl$), takeUntil(this._destroy$))
            .subscribe({
            next: (e) => this.hideOnClickOutsideHandler(e)
        });
        fromEvent(this._getScrollParent(this.getRefElement()), "scroll")
            .pipe(takeUntil(this._globalEventListenersCtrl$), takeUntil(this._destroy$))
            .subscribe({
            next: (e) => {
                this.hideOnScrollHandler(e);
            }
        });
    }
    toggle() {
        if (this.disabled) {
            return;
        }
        this._shown ? this.scheduledHide(null, this.hideTimeout) : this.scheduledShow();
    }
    _addListener(eventName, cb) {
        fromEvent(this._elementRef.nativeElement, eventName)
            .pipe(takeUntil(this._destroy$))
            .subscribe({
            next: cb
        });
    }
    _applyChanges() {
        this._changeDetectorRef.markForCheck();
        this._changeDetectorRef.detectChanges();
    }
    _checkExisting(key, newValue) {
        if (this._content) {
            this._content.floatUiOptions[key] = newValue;
            if (!this._shown) {
                return;
            }
            this._content.update();
        }
    }
    _constructContent() {
        this._contentRef = this._vcr.createComponent(this._contentClass);
        return this._contentRef.instance;
    }
    _getScrollParent(node) {
        const isElement = node instanceof HTMLElement;
        const overflowY = isElement && window.getComputedStyle(node).overflowY;
        const isScrollable = overflowY !== "visible" && overflowY !== "hidden";
        if (!node) {
            return null;
        }
        else if (isScrollable && node.scrollHeight > node.clientHeight) {
            return node;
        }
        return this._getScrollParent(node.parentNode) || document;
    }
    _onPopperUpdate() {
        this.onUpdate.emit();
    }
    _setContentProperties(popperRef) {
        popperRef.floatUiOptions = NgxFloatUiDirective.assignDefined(popperRef.floatUiOptions, NgxFloatUiDirective.baseOptions, {
            showDelay: this.showDelay,
            disableAnimation: this.disableAnimation,
            disableDefaultStyling: this.disableStyle,
            placement: this.placement,
            boundariesElement: this.boundariesElement,
            trigger: this.showTrigger,
            positionFixed: this.positionFixed,
            ariaDescribe: this.ariaDescribe,
            ariaRole: this.ariaRole,
            applyClass: this.applyClass,
            applyArrowClass: this.arrowClass,
            hideOnMouseLeave: this.hideOnMouseLeave,
            styles: this.styles,
            appendTo: this.appendTo,
            preventOverflow: this.preventOverflow,
        });
        popperRef.onUpdate = this._onPopperUpdate.bind(this);
        popperRef.onHidden
            .pipe(takeUntil(this._destroy$))
            .subscribe(this.hide.bind(this));
    }
    _setDefaults() {
        ["showDelay", "hideOnScroll", "hideOnMouseLeave", "hideOnClickOutside", "ariaRole", "ariaDescribe"].forEach((key) => {
            this[key] = this[key] === void 0 ? NgxFloatUiDirective.baseOptions[key] : this[key];
        });
        this.showTrigger = this.showTrigger || NgxFloatUiDirective.baseOptions.trigger;
        this.styles = this.styles === void 0 ? { ...NgxFloatUiDirective.baseOptions.styles } : this.styles;
    }
    /** @nocollapse */ static ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.0.4", ngImport: i0, type: NgxFloatUiDirective, deps: [{ token: i0.ChangeDetectorRef }, { token: i0.ElementRef }, { token: i0.ViewContainerRef }, { token: NGX_FLOAT_UI_DEFAULTS }], target: i0.ɵɵFactoryTarget.Directive });
    /** @nocollapse */ static ɵdir = i0.ɵɵngDeclareDirective({ minVersion: "14.0.0", version: "18.0.4", type: NgxFloatUiDirective, isStandalone: true, selector: "[floatUi]", inputs: { applyClass: "applyClass", arrowClass: "arrowClass", disabled: "disabled", floatUi: "floatUi", hideOnClickOutside: "hideOnClickOutside", placement: "placement", preventOverflow: "preventOverflow", showOnStart: "showOnStart", appendTo: "appendTo", ariaDescribe: "ariaDescribe", ariaRole: "ariaRole", boundariesElement: "boundariesElement", disableAnimation: "disableAnimation", disableStyle: "disableStyle", hideOnMouseLeave: "hideOnMouseLeave", hideOnScroll: "hideOnScroll", hideTimeout: "hideTimeout", positionFixed: "positionFixed", showDelay: "showDelay", showTrigger: "showTrigger", styles: "styles", targetElement: "targetElement", timeoutAfterShow: "timeoutAfterShow" }, outputs: { onHidden: "onHidden", onShown: "onShown", onUpdate: "onUpdate" }, exportAs: ["floatUi"], ngImport: i0 });
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.0.4", ngImport: i0, type: NgxFloatUiDirective, decorators: [{
            type: Directive,
            args: [{
                    selector: "[floatUi]",
                    exportAs: "floatUi",
                    standalone: true
                }]
        }], ctorParameters: () => [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: i0.ViewContainerRef }, { type: undefined, decorators: [{
                    type: Inject,
                    args: [NGX_FLOAT_UI_DEFAULTS]
                }] }], propDecorators: { applyClass: [{
                type: Input
            }], arrowClass: [{
                type: Input
            }], disabled: [{
                type: Input
            }], floatUi: [{
                type: Input
            }], hideOnClickOutside: [{
                type: Input
            }], placement: [{
                type: Input
            }], preventOverflow: [{
                type: Input
            }], showOnStart: [{
                type: Input
            }], appendTo: [{
                type: Input
            }], ariaDescribe: [{
                type: Input
            }], ariaRole: [{
                type: Input
            }], boundariesElement: [{
                type: Input
            }], disableAnimation: [{
                type: Input
            }], disableStyle: [{
                type: Input
            }], hideOnMouseLeave: [{
                type: Input
            }], hideOnScroll: [{
                type: Input
            }], hideTimeout: [{
                type: Input
            }], onHidden: [{
                type: Output
            }], onShown: [{
                type: Output
            }], onUpdate: [{
                type: Output
            }], positionFixed: [{
                type: Input
            }], showDelay: [{
                type: Input
            }], showTrigger: [{
                type: Input
            }], styles: [{
                type: Input
            }], targetElement: [{
                type: Input
            }], timeoutAfterShow: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LWZsb2F0LXVpLmRpcmVjdGl2ZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL25neC1mbG9hdC11aS9zcmMvbGliL2RpcmVjdGl2ZXMvbmd4LWZsb2F0LXVpL25neC1mbG9hdC11aS5kaXJlY3RpdmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUdILFNBQVMsRUFFVCxZQUFZLEVBQ1osTUFBTSxFQUNOLEtBQUssRUFHTCxNQUFNLEVBRVQsTUFBTSxlQUFlLENBQUM7QUFDdkIsRUFBRTtBQUNGLE9BQU8sRUFBQyxTQUFTLEVBQUUsT0FBTyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQUMsTUFBTSxNQUFNLENBQUM7QUFDMUQsT0FBTyxFQUFDLDBCQUEwQixFQUFDLE1BQU0sc0VBQXNFLENBQUM7QUFDaEgsT0FBTyxFQUFDLHFCQUFxQixFQUFDLE1BQU0sMENBQTBDLENBQUM7QUFHL0UsT0FBTyxFQUFDLGtCQUFrQixFQUFDLE1BQU0sMENBQTBDLENBQUM7QUFDNUUsT0FBTyxFQUFDLGVBQWUsRUFBQyxNQUFNLHVDQUF1QyxDQUFDOztBQU90RSxNQUFNLE9BQU8sbUJBQW1CO0lBZ01OO0lBQ0E7SUFDQTtJQUMrQjtJQWpNckQsTUFBTSxDQUFDLFdBQVcsR0FBc0I7UUFDcEMsU0FBUyxFQUFFLENBQUM7UUFDWixrQkFBa0IsRUFBRSxJQUFJO1FBQ3hCLGdCQUFnQixFQUFFLEtBQUs7UUFDdkIsWUFBWSxFQUFFLEtBQUs7UUFDbkIsUUFBUSxFQUFFLFNBQVM7UUFDbkIsUUFBUSxFQUFFLFFBQVE7UUFDbEIsWUFBWSxFQUFFLEVBQUU7UUFDaEIsTUFBTSxFQUFFLEVBQUU7UUFDVixPQUFPLEVBQUUsa0JBQWtCLENBQUMsS0FBSztLQUNwQyxDQUFDO0lBRUYsSUFDSSxVQUFVLENBQUMsUUFBZ0I7UUFDM0IsSUFBSSxRQUFRLEtBQUssSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO1lB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QUlOLFlBQVk7c0JBRFgsS0FBSztnQkFJTixRQUFRO3NCQURQLEtBQUs7Z0JBSU4saUJBQWlCO3NCQURoQixLQUFLO2dCQUlOLGdCQUFnQjtzQkFEZixLQUFLO2dCQUlOLFlBQVk7c0JBRFgsS0FBSztnQkFJTixnQkFBZ0I7c0JBRGYsS0FBSztnQkFJTixZQUFZO3NCQURYLEtBQUs7Z0JBSU4sV0FBVztzQkFEVixLQUFLO2dCQUlOLFFBQVE7c0JBRFAsTUFBTTtnQkFJUCxPQUFPO3NCQUROLE1BQU07Z0JBSVAsUUFBUTtzQkFEUCxNQUFNO2dCQUlQLGFBQWE7c0JBRFosS0FBSztnQkFJTixTQUFTO3NCQURSLEtBQUs7Z0JBSU4sV0FBVztzQkFEVixLQUFLO2dCQUlOLE1BQU07c0JBREwsS0FBSztnQkFJTixhQUFhO3NCQURaLEtBQUs7Z0JBSU4sZ0JBQWdCO3NCQURmLEtBQUsiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICAgIENoYW5nZURldGVjdG9yUmVmLFxuICAgIENvbXBvbmVudFJlZixcbiAgICBEaXJlY3RpdmUsXG4gICAgRWxlbWVudFJlZixcbiAgICBFdmVudEVtaXR0ZXIsXG4gICAgSW5qZWN0LFxuICAgIElucHV0LFxuICAgIE9uRGVzdHJveSxcbiAgICBPbkluaXQsXG4gICAgT3V0cHV0LFxuICAgIFZpZXdDb250YWluZXJSZWZcbn0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcbi8vXG5pbXBvcnQge2Zyb21FdmVudCwgU3ViamVjdCwgdGFrZVVudGlsLCB0aW1lcn0gZnJvbSBcInJ4anNcIjtcbmltcG9ydCB7Tmd4RmxvYXRVaUNvbnRlbnRDb21wb25lbnR9IGZyb20gXCIuLi8uLi9jb21wb25lbnRzL25neC1mbG9hdC11aS1jb250ZW50L25neC1mbG9hdC11aS1jb250ZW50LmNvbXBvbmVudFwiO1xuaW1wb3J0IHtOR1hfRkxPQVRfVUlfREVGQVVMVFN9IGZyb20gXCIuLi8uLi9tb2RlbHMvbmd4LWZsb2F0LXVpLWRlZmF1bHRzLm1vZGVsXCI7XG5pbXBvcnQge05neEZsb2F0VWlPcHRpb25zfSBmcm9tIFwiLi4vLi4vbW9kZWxzL25neC1mbG9hdC11aS1vcHRpb25zLm1vZGVsXCI7XG5pbXBvcnQge05neEZsb2F0VWlQbGFjZW1lbnRzfSBmcm9tIFwiLi4vLi4vbW9kZWxzL25neC1mbG9hdC11aS1wbGFjZW1lbnRzLm1vZGVsXCI7XG5pbXBvcnQge05neEZsb2F0VWlUcmlnZ2Vyc30gZnJvbSBcIi4uLy4uL21vZGVscy9uZ3gtZmxvYXQtdWktdHJpZ2dlcnMubW9kZWxcIjtcbmltcG9ydCB7Tmd4RmxvYXRVaVV0aWxzfSBmcm9tIFwiLi4vLi4vbW9kZWxzL25neC1mbG9hdC11aS11dGlscy5jbGFzc1wiO1xuXG5ARGlyZWN0aXZlKHtcbiAgICBzZWxlY3RvcjogXCJbZmxvYXRVaV1cIixcbiAgICBleHBvcnRBczogXCJmbG9hdFVpXCIsXG4gICAgc3RhbmRhbG9uZTogdHJ1ZVxufSlcbmV4cG9ydCBjbGFzcyBOZ3hGbG9hdFVpRGlyZWN0aXZlIGltcGxlbWVudHMgT25Jbml0LCBPbkRlc3Ryb3kge1xuXG4gICAgc3RhdGljIGJhc2VPcHRpb25zOiBOZ3hGbG9hdFVpT3B0aW9ucyA9IHtcbiAgICAgICAgc2hvd0RlbGF5OiAwLFxuICAgICAgICBoaWRlT25DbGlja091dHNpZGU6IHRydWUsXG4gICAgICAgIGhpZGVPbk1vdXNlTGVhdmU6IGZhbHNlLFxuICAgICAgICBoaWRlT25TY3JvbGw6IGZhbHNlLFxuICAgICAgICBhcHBlbmRUbzogdW5kZWZpbmVkLFxuICAgICAgICBhcmlhUm9sZTogXCJwb3BwZXJcIixcbiAgICAgICAgYXJpYURlc2NyaWJlOiBcIlwiLFxuICAgICAgICBzdHlsZXM6IHt9LFxuICAgICAgICB0cmlnZ2VyOiBOZ3hGbG9hdFVpVHJpZ2dlcnMuY2xpY2tcbiAgICB9O1xuXG4gICAgQElucHV0KClcbiAgICBzZXQgYXBwbHlDbGFzcyhuZXdWYWx1ZTogc3RyaW5nKSB7XG4gICAgICAgIGlmIChuZXdWYWx1ZSA9PT0gdGhpcy5fYXBwbHlDbGFzcykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2FwcGx5Q2xhc3MgPSBuZXdWYWx1ZTtcbiAgICAgICAgdGhpcy5fY2hlY2tFeGlzdGluZyhcImFwcGx5Q2xhc3NcIiwgbmV3VmFsdWUpO1xuICAgIH1cblxuICAgIGdldCBhcHBseUNsYXNzKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hcHBseUNsYXNzO1xuICAgIH1cblxuICAgIEBJbnB1dCgpXG4gICAgc2V0IGFycm93Q2xhc3MobmV3VmFsdWU6IHN0cmluZykge1xuICAgICAgICBpZiAobmV3VmFsdWUgPT09IHRoaXMuX2Fycm93Q2xhc3MpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9hcnJvd0NsYXNzID0gbmV3VmFsdWU7XG4gICAgICAgIGlmICh0aGlzLl9jb250ZW50KSB7XG4gICAgICAgICAgICB0aGlzLl9jb250ZW50LmZsb2F0VWlPcHRpb25zLmFwcGx5QXJyb3dDbGFzcyA9IG5ld1ZhbHVlO1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9zaG93bikge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX2NvbnRlbnQudXBkYXRlKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXQgYXJyb3dDbGFzcygpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5fYXJyb3dDbGFzcztcbiAgICB9XG5cbiAgICBASW5wdXQoKVxuICAgIHNldCBkaXNhYmxlZChuZXdWYWx1ZTogYm9vbGVhbikge1xuICAgICAgICBpZiAobmV3VmFsdWUgPT09IHRoaXMuX2Rpc2FibGVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fZGlzYWJsZWQgPSAhIW5ld1ZhbHVlO1xuICAgICAgICBpZiAodGhpcy5fc2hvd24pIHtcbiAgICAgICAgICAgIHRoaXMuaGlkZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0IGRpc2FibGVkKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5fZGlzYWJsZWQ7XG4gICAgfVxuXG4gICAgQElucHV0KClcbiAgICBzZXQgZmxvYXRVaShuZXdWYWx1ZTogc3RyaW5nIHwgTmd4RmxvYXRVaUNvbnRlbnRDb21wb25lbnQpIHtcbiAgICAgICAgaWYgKG5ld1ZhbHVlID09PSB0aGlzLl9mbG9hdFVpKSB7XG5cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9mbG9hdFVpID0gbmV3VmFsdWU7XG4gICAgICAgIGlmICh0aGlzLl9jb250ZW50KSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIG5ld1ZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fY29udGVudC50ZXh0ID0gbmV3VmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jb250ZW50ID0gbmV3VmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXQgZmxvYXRVaSgpOiBzdHJpbmcgfCBOZ3hGbG9hdFVpQ29udGVudENvbXBvbmVudCB7XG4gICAgICAgIHJldHVybiB0aGlzLl9mbG9hdFVpO1xuICAgIH1cblxuICAgIEBJbnB1dCgpXG4gICAgc2V0IGhpZGVPbkNsaWNrT3V0c2lkZShuZXdWYWx1ZTogYm9vbGVhbiB8IHN0cmluZykge1xuICAgICAgICB0aGlzLl9oaWRlT25DbGlja091dHNpZGUgPSBOZ3hGbG9hdFVpVXRpbHMuY29lcmNlQm9vbGVhblByb3BlcnR5KG5ld1ZhbHVlKTtcbiAgICB9XG5cbiAgICBnZXQgaGlkZU9uQ2xpY2tPdXRzaWRlKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5faGlkZU9uQ2xpY2tPdXRzaWRlO1xuICAgIH1cblxuICAgIEBJbnB1dCgpXG4gICAgc2V0IHBsYWNlbWVudChuZXdWYWx1ZTogTmd4RmxvYXRVaVBsYWNlbWVudHMpIHtcbiAgICAgICAgdGhpcy5fcGxhY2VtZW50ID0gbmV3VmFsdWU7XG4gICAgICAgIHRoaXMuX2NoZWNrRXhpc3RpbmcoXCJwbGFjZW1lbnRcIiwgbmV3VmFsdWUpO1xuICAgIH1cblxuICAgIGdldCBwbGFjZW1lbnQoKTogTmd4RmxvYXRVaVBsYWNlbWVudHMge1xuXG4gICAgICAgIHJldHVybiB0aGlzLl9wbGFjZW1lbnQ7XG4gICAgfVxuXG4gICAgQElucHV0KClcbiAgICBzZXQgcHJldmVudE92ZXJmbG93KG5ld1ZhbHVlOiBib29sZWFuKSB7XG4gICAgICAgIHRoaXMuX3ByZXZlbnRPdmVyZmxvdyA9IE5neEZsb2F0VWlVdGlscy5jb2VyY2VCb29sZWFuUHJvcGVydHkobmV3VmFsdWUpO1xuICAgICAgICB0aGlzLl9jaGVja0V4aXN0aW5nKFwicHJldmVudE92ZXJmbG93XCIsIHRoaXMuX3ByZXZlbnRPdmVyZmxvdyk7XG4gICAgfVxuXG4gICAgZ2V0IHByZXZlbnRPdmVyZmxvdygpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3ByZXZlbnRPdmVyZmxvdztcbiAgICB9XG5cbiAgICBASW5wdXQoKVxuICAgIHNldCBzaG93T25TdGFydChuZXdWYWx1ZTogYm9vbGVhbikge1xuICAgICAgICB0aGlzLl9zaG93T25TdGFydCA9IE5neEZsb2F0VWlVdGlscy5jb2VyY2VCb29sZWFuUHJvcGVydHkobmV3VmFsdWUpO1xuICAgIH1cblxuICAgIGdldCBzaG93T25TdGFydCgpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Nob3dPblN0YXJ0O1xuICAgIH1cblxuICAgIEBJbnB1dCgpXG4gICAgYXBwZW5kVG86IHN0cmluZztcblxuICAgIEBJbnB1dCgpXG4gICAgYXJpYURlc2NyaWJlOiBzdHJpbmcgfCB2b2lkO1xuXG4gICAgQElucHV0KClcbiAgICBhcmlhUm9sZTogc3RyaW5nIHwgdm9pZDtcblxuICAgIEBJbnB1dCgpXG4gICAgYm91bmRhcmllc0VsZW1lbnQ6IHN0cmluZztcblxuICAgIEBJbnB1dCgpXG4gICAgZGlzYWJsZUFuaW1hdGlvbjogYm9vbGVhbjtcblxuICAgIEBJbnB1dCgpXG4gICAgZGlzYWJsZVN0eWxlOiBib29sZWFuO1xuXG4gICAgQElucHV0KClcbiAgICBoaWRlT25Nb3VzZUxlYXZlOiBib29sZWFuIHwgdm9pZDtcblxuICAgIEBJbnB1dCgpXG4gICAgaGlkZU9uU2Nyb2xsOiBib29sZWFuIHwgdm9pZDtcblxuICAgIEBJbnB1dCgpXG4gICAgaGlkZVRpbWVvdXQ6IG51bWJlciA9IDA7XG5cbiAgICBAT3V0cHV0KClcbiAgICBvbkhpZGRlbjogRXZlbnRFbWl0dGVyPE5neEZsb2F0VWlEaXJlY3RpdmU+ID0gbmV3IEV2ZW50RW1pdHRlcjxOZ3hGbG9hdFVpRGlyZWN0aXZlPigpO1xuXG4gICAgQE91dHB1dCgpXG4gICAgb25TaG93bjogRXZlbnRFbWl0dGVyPE5neEZsb2F0VWlEaXJlY3RpdmU+ID0gbmV3IEV2ZW50RW1pdHRlcjxOZ3hGbG9hdFVpRGlyZWN0aXZlPigpO1xuXG4gICAgQE91dHB1dCgpXG4gICAgb25VcGRhdGU6IEV2ZW50RW1pdHRlcjx2b2lkPiA9IG5ldyBFdmVudEVtaXR0ZXI8dm9pZD4oKTtcblxuICAgIEBJbnB1dCgpXG4gICAgcG9zaXRpb25GaXhlZDogYm9vbGVhbjtcblxuICAgIEBJbnB1dCgpXG4gICAgc2hvd0RlbGF5OiBudW1iZXIgfCB1bmRlZmluZWQ7XG5cbiAgICBASW5wdXQoKVxuICAgIHNob3dUcmlnZ2VyOiBOZ3hGbG9hdFVpVHJpZ2dlcnMgfCB1bmRlZmluZWQ7XG5cbiAgICBASW5wdXQoKVxuICAgIHN0eWxlczogb2JqZWN0O1xuXG4gICAgQElucHV0KClcbiAgICB0YXJnZXRFbGVtZW50OiBIVE1MRWxlbWVudDtcblxuICAgIEBJbnB1dCgpXG4gICAgdGltZW91dEFmdGVyU2hvdzogbnVtYmVyID0gMDtcblxuICAgIHByb3RlY3RlZCBfYXBwbHlDbGFzczogc3RyaW5nO1xuICAgIHByb3RlY3RlZCBfYXJyb3dDbGFzczogc3RyaW5nO1xuICAgIHByb3RlY3RlZCBfY29udGVudDogTmd4RmxvYXRVaUNvbnRlbnRDb21wb25lbnQ7XG4gICAgcHJvdGVjdGVkIF9jb250ZW50Q2xhc3MgPSBOZ3hGbG9hdFVpQ29udGVudENvbXBvbmVudDtcbiAgICBwcm90ZWN0ZWQgX2NvbnRlbnRSZWY6IENvbXBvbmVudFJlZjxOZ3hGbG9hdFVpQ29udGVudENvbXBvbmVudD47XG4gICAgcHJvdGVjdGVkIF9kZXN0cm95JDogU3ViamVjdDx2b2lkPiA9IG5ldyBTdWJqZWN0PHZvaWQ+KCk7XG4gICAgcHJvdGVjdGVkIF9kaXNhYmxlZDogYm9vbGVhbjtcbiAgICBwcm90ZWN0ZWQgX2Zsb2F0VWk6IHN0cmluZyB8IE5neEZsb2F0VWlDb250ZW50Q29tcG9uZW50O1xuICAgIHByb3RlY3RlZCBfZ2xvYmFsRXZlbnRMaXN0ZW5lcnNDdHJsJDogU3ViamVjdDx2b2lkPiA9IG5ldyBTdWJqZWN0PHZvaWQ+KCk7XG4gICAgcHJvdGVjdGVkIF9oaWRlT25DbGlja091dHNpZGU6IGJvb2xlYW4gPSAhMDtcbiAgICBwcm90ZWN0ZWQgX3BsYWNlbWVudDogTmd4RmxvYXRVaVBsYWNlbWVudHM7XG4gICAgcHJvdGVjdGVkIF9wcmV2ZW50T3ZlcmZsb3c6IGJvb2xlYW47XG4gICAgcHJvdGVjdGVkIF9zY2hlZHVsZWRIaWRlVGltZW91dEN0cmwkOiBTdWJqZWN0PHZvaWQ+ID0gbmV3IFN1YmplY3Q8dm9pZD4oKTtcbiAgICBwcm90ZWN0ZWQgX3NjaGVkdWxlZFNob3dUaW1lb3V0Q3RybCQ6IFN1YmplY3Q8dm9pZD4gPSBuZXcgU3ViamVjdDx2b2lkPigpO1xuICAgIHByb3RlY3RlZCBfc2hvd246IGJvb2xlYW4gPSAhMTtcbiAgICBwcm90ZWN0ZWQgX3Nob3dPblN0YXJ0OiBib29sZWFuID0gITE7XG5cbiAgICBjb25zdHJ1Y3Rvcihwcm90ZWN0ZWQgX2NoYW5nZURldGVjdG9yUmVmOiBDaGFuZ2VEZXRlY3RvclJlZixcbiAgICAgICAgICAgICAgICBwcm90ZWN0ZWQgX2VsZW1lbnRSZWY6IEVsZW1lbnRSZWYsXG4gICAgICAgICAgICAgICAgcHJvdGVjdGVkIF92Y3I6IFZpZXdDb250YWluZXJSZWYsXG4gICAgICAgICAgICAgICAgQEluamVjdChOR1hfRkxPQVRfVUlfREVGQVVMVFMpIHByb3RlY3RlZCBfcG9wcGVyRGVmYXVsdHM6IE5neEZsb2F0VWlPcHRpb25zID0ge30pIHtcbiAgICAgICAgTmd4RmxvYXRVaURpcmVjdGl2ZS5iYXNlT3B0aW9ucyA9IHsuLi5OZ3hGbG9hdFVpRGlyZWN0aXZlLmJhc2VPcHRpb25zLCAuLi50aGlzLl9wb3BwZXJEZWZhdWx0c307XG4gICAgfVxuXG4gICAgc3RhdGljIGFzc2lnbkRlZmluZWQodGFyZ2V0OiBhbnksIC4uLnNvdXJjZXM6IGFueVtdKSB7XG4gICAgICAgIGZvciAoY29uc3Qgc291cmNlIG9mIHNvdXJjZXMpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IG9mIE9iamVjdC5rZXlzKHNvdXJjZSkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB2YWwgPSBzb3VyY2Vba2V5XTtcbiAgICAgICAgICAgICAgICBpZiAodmFsICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0W2tleV0gPSB2YWw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRhcmdldDtcbiAgICB9XG5cbiAgICBhcHBseVRyaWdnZXJMaXN0ZW5lcnMoKSB7XG4gICAgICAgIHN3aXRjaCAodGhpcy5zaG93VHJpZ2dlcikge1xuICAgICAgICAgICAgY2FzZSBOZ3hGbG9hdFVpVHJpZ2dlcnMuY2xpY2s6XG4gICAgICAgICAgICAgICAgdGhpcy5fYWRkTGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLnRvZ2dsZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgTmd4RmxvYXRVaVRyaWdnZXJzLm1vdXNlZG93bjpcbiAgICAgICAgICAgICAgICB0aGlzLl9hZGRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCB0aGlzLnRvZ2dsZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgTmd4RmxvYXRVaVRyaWdnZXJzLmhvdmVyOlxuICAgICAgICAgICAgICAgIHRoaXMuX2FkZExpc3RlbmVyKFwibW91c2VlbnRlclwiLCB0aGlzLnNjaGVkdWxlZFNob3cuYmluZCh0aGlzLCB0aGlzLnNob3dEZWxheSkpO1xuICAgICAgICAgICAgICAgIFtcInRvdWNoZW5kXCIsIFwidG91Y2hjYW5jZWxcIiwgXCJtb3VzZWxlYXZlXCJdLmZvckVhY2goKGV2ZW50TmFtZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZGRMaXN0ZW5lcihldmVudE5hbWUsIHRoaXMuc2NoZWR1bGVkSGlkZS5iaW5kKHRoaXMsIG51bGwsIHRoaXMuaGlkZVRpbWVvdXQpKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5zaG93VHJpZ2dlciAhPT0gTmd4RmxvYXRVaVRyaWdnZXJzLmhvdmVyICYmIHRoaXMuaGlkZU9uTW91c2VMZWF2ZSkge1xuICAgICAgICAgICAgW1widG91Y2hlbmRcIiwgXCJ0b3VjaGNhbmNlbFwiLCBcIm1vdXNlbGVhdmVcIl0uZm9yRWFjaCgoZXZlbnROYW1lKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYWRkTGlzdGVuZXIoZXZlbnROYW1lLCB0aGlzLnNjaGVkdWxlZEhpZGUuYmluZCh0aGlzLCBudWxsLCB0aGlzLmhpZGVUaW1lb3V0KSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldFJlZkVsZW1lbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRhcmdldEVsZW1lbnQgfHwgdGhpcy5fZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50O1xuICAgIH1cblxuICAgIGhpZGUoKSB7XG4gICAgICAgIGlmICh0aGlzLmRpc2FibGVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLl9zaG93bikge1xuICAgICAgICAgICAgdGhpcy5fc2NoZWR1bGVkU2hvd1RpbWVvdXRDdHJsJC5uZXh0KCk7XG5cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX3Nob3duID0gZmFsc2U7XG4gICAgICAgIGlmICh0aGlzLl9jb250ZW50UmVmKSB7XG4gICAgICAgICAgICB0aGlzLl9jb250ZW50UmVmLmluc3RhbmNlLmhpZGUoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2NvbnRlbnQuaGlkZSgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMub25IaWRkZW4uZW1pdCh0aGlzKTtcbiAgICAgICAgdGhpcy5fZ2xvYmFsRXZlbnRMaXN0ZW5lcnNDdHJsJC5uZXh0KCk7XG4gICAgfVxuXG4gICAgaGlkZU9uQ2xpY2tPdXRzaWRlSGFuZGxlcigkZXZlbnQ6IE1vdXNlRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuZGlzYWJsZWQgfHwgIXRoaXMuaGlkZU9uQ2xpY2tPdXRzaWRlIHx8ICRldmVudC50YXJnZXQgPT09IHRoaXMuX2NvbnRlbnQuZWxSZWYubmF0aXZlRWxlbWVudCB8fFxuICAgICAgICAgICAgdGhpcy5fY29udGVudC5lbFJlZi5uYXRpdmVFbGVtZW50LmNvbnRhaW5zKCRldmVudC50YXJnZXQpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zY2hlZHVsZWRIaWRlKCRldmVudCwgdGhpcy5oaWRlVGltZW91dCk7XG4gICAgfVxuXG4gICAgaGlkZU9uU2Nyb2xsSGFuZGxlcigkZXZlbnQ6IE1vdXNlRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuZGlzYWJsZWQgfHwgIXRoaXMuaGlkZU9uU2Nyb2xsKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zY2hlZHVsZWRIaWRlKCRldmVudCwgdGhpcy5oaWRlVGltZW91dCk7XG4gICAgfVxuXG4gICAgbmdPbkRlc3Ryb3koKSB7XG4gICAgICAgIHRoaXMuX2Rlc3Ryb3kkLm5leHQoKTtcbiAgICAgICAgdGhpcy5fZGVzdHJveSQuY29tcGxldGUoKTtcbiAgICAgICAgdGhpcy5fY29udGVudCAmJiB0aGlzLl9jb250ZW50LmNsZWFuKCk7XG4gICAgfVxuXG4gICAgbmdPbkluaXQoKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5mbG9hdFVpID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICB0aGlzLl9jb250ZW50ID0gdGhpcy5fY29uc3RydWN0Q29udGVudCgpO1xuICAgICAgICAgICAgdGhpcy5fY29udGVudC50ZXh0ID0gdGhpcy5mbG9hdFVpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHR5cGVvZiB0aGlzLmZsb2F0VWkgPT09IHR5cGVvZiB2b2lkIDApIHtcbiAgICAgICAgICAgIHRoaXMuX2NvbnRlbnQgPSB0aGlzLl9jb25zdHJ1Y3RDb250ZW50KCk7XG4gICAgICAgICAgICB0aGlzLl9jb250ZW50LnRleHQgPSBcIlwiO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fY29udGVudCA9IHRoaXMuZmxvYXRVaTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBwb3BwZXJSZWYgPSB0aGlzLl9jb250ZW50O1xuICAgICAgICBwb3BwZXJSZWYucmVmZXJlbmNlT2JqZWN0ID0gdGhpcy5nZXRSZWZFbGVtZW50KCk7XG4gICAgICAgIHRoaXMuX3NldENvbnRlbnRQcm9wZXJ0aWVzKHBvcHBlclJlZik7XG4gICAgICAgIHRoaXMuX3NldERlZmF1bHRzKCk7XG4gICAgICAgIHRoaXMuYXBwbHlUcmlnZ2VyTGlzdGVuZXJzKCk7XG4gICAgICAgIGlmICh0aGlzLnNob3dPblN0YXJ0KSB7XG4gICAgICAgICAgICB0aGlzLnNjaGVkdWxlZFNob3coKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNjaGVkdWxlZEhpZGUoJGV2ZW50OiBhbnkgPSBudWxsLCBkZWxheTogbnVtYmVyID0gdGhpcy5oaWRlVGltZW91dCkge1xuICAgICAgICBpZiAodGhpcy5kaXNhYmxlZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3NjaGVkdWxlZEhpZGVUaW1lb3V0Q3RybCQubmV4dCgpO1xuICAgICAgICB0aW1lcihkZWxheSlcbiAgICAgICAgICAgIC5waXBlKHRha2VVbnRpbCh0aGlzLl9zY2hlZHVsZWRIaWRlVGltZW91dEN0cmwkKSwgdGFrZVVudGlsKHRoaXMuX2Rlc3Ryb3kkKSlcbiAgICAgICAgICAgIC5zdWJzY3JpYmUoe1xuICAgICAgICAgICAgICAgIG5leHQ6ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVE9ETzogY2hlY2tcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdG9FbGVtZW50ID0gJGV2ZW50ID8gJGV2ZW50LnRvRWxlbWVudCA6IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHBvcHBlckNvbnRlbnRWaWV3ID0gdGhpcy5fY29udGVudC5mbG9hdFVpVmlld1JlZiA/IHRoaXMuX2NvbnRlbnQuZmxvYXRVaVZpZXdSZWYubmF0aXZlRWxlbWVudCA6IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXBvcHBlckNvbnRlbnRWaWV3IHx8XG4gICAgICAgICAgICAgICAgICAgICAgICBwb3BwZXJDb250ZW50VmlldyA9PT0gdG9FbGVtZW50IHx8XG4gICAgICAgICAgICAgICAgICAgICAgICBwb3BwZXJDb250ZW50Vmlldy5jb250YWlucyh0b0VsZW1lbnQpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAodGhpcy5mbG9hdFVpICYmICh0aGlzLmZsb2F0VWkgYXMgTmd4RmxvYXRVaUNvbnRlbnRDb21wb25lbnQpLmlzTW91c2VPdmVyKSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2FwcGx5Q2hhbmdlcygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIHNjaGVkdWxlZFNob3coZGVsYXk6IG51bWJlciA9IHRoaXMuc2hvd0RlbGF5KSB7XG4gICAgICAgIGlmICh0aGlzLmRpc2FibGVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fc2NoZWR1bGVkSGlkZVRpbWVvdXRDdHJsJC5uZXh0KCk7XG4gICAgICAgIHRpbWVyKGRlbGF5KVxuICAgICAgICAgICAgLnBpcGUodGFrZVVudGlsKHRoaXMuX3NjaGVkdWxlZFNob3dUaW1lb3V0Q3RybCQpLCB0YWtlVW50aWwodGhpcy5fZGVzdHJveSQpKVxuICAgICAgICAgICAgLnN1YnNjcmliZSh7XG4gICAgICAgICAgICAgICAgbmV4dDogKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3coKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYXBwbHlDaGFuZ2VzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgc2hvdygpIHtcbiAgICAgICAgaWYgKHRoaXMuX3Nob3duKSB7XG4gICAgICAgICAgICB0aGlzLl9zY2hlZHVsZWRIaWRlVGltZW91dEN0cmwkLm5leHQoKTtcblxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fc2hvd24gPSB0cnVlO1xuICAgICAgICBjb25zdCBwb3BwZXJSZWYgPSB0aGlzLl9jb250ZW50O1xuICAgICAgICBjb25zdCBlbGVtZW50ID0gdGhpcy5nZXRSZWZFbGVtZW50KCk7XG4gICAgICAgIGlmIChwb3BwZXJSZWYucmVmZXJlbmNlT2JqZWN0ICE9PSBlbGVtZW50KSB7XG4gICAgICAgICAgICBwb3BwZXJSZWYucmVmZXJlbmNlT2JqZWN0ID0gZWxlbWVudDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9zZXRDb250ZW50UHJvcGVydGllcyhwb3BwZXJSZWYpO1xuICAgICAgICBwb3BwZXJSZWYuc2hvdygpO1xuICAgICAgICB0aGlzLm9uU2hvd24uZW1pdCh0aGlzKTtcbiAgICAgICAgaWYgKHRoaXMudGltZW91dEFmdGVyU2hvdyA+IDApIHtcbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVkSGlkZShudWxsLCB0aGlzLnRpbWVvdXRBZnRlclNob3cpO1xuICAgICAgICB9XG4gICAgICAgIGZyb21FdmVudChkb2N1bWVudCwgXCJjbGlja1wiKVxuICAgICAgICAgICAgLnBpcGUodGFrZVVudGlsKHRoaXMuX2dsb2JhbEV2ZW50TGlzdGVuZXJzQ3RybCQpLCB0YWtlVW50aWwodGhpcy5fZGVzdHJveSQpKVxuICAgICAgICAgICAgLnN1YnNjcmliZSh7XG4gICAgICAgICAgICAgICAgbmV4dDogKGU6IE1vdXNlRXZlbnQpID0+IHRoaXMuaGlkZU9uQ2xpY2tPdXRzaWRlSGFuZGxlcihlKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIGZyb21FdmVudCh0aGlzLl9nZXRTY3JvbGxQYXJlbnQodGhpcy5nZXRSZWZFbGVtZW50KCkpLCBcInNjcm9sbFwiKVxuICAgICAgICAgICAgLnBpcGUodGFrZVVudGlsKHRoaXMuX2dsb2JhbEV2ZW50TGlzdGVuZXJzQ3RybCQpLCB0YWtlVW50aWwodGhpcy5fZGVzdHJveSQpKVxuICAgICAgICAgICAgLnN1YnNjcmliZSh7XG4gICAgICAgICAgICAgICAgbmV4dDogKGU6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oaWRlT25TY3JvbGxIYW5kbGVyKGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIHRvZ2dsZSgpIHtcbiAgICAgICAgaWYgKHRoaXMuZGlzYWJsZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9zaG93biA/IHRoaXMuc2NoZWR1bGVkSGlkZShudWxsLCB0aGlzLmhpZGVUaW1lb3V0KSA6IHRoaXMuc2NoZWR1bGVkU2hvdygpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBfYWRkTGlzdGVuZXIoZXZlbnROYW1lOiBzdHJpbmcsIGNiOiAoKSA9PiB2b2lkKTogdm9pZCB7XG4gICAgICAgIGZyb21FdmVudCh0aGlzLl9lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQsIGV2ZW50TmFtZSlcbiAgICAgICAgICAgIC5waXBlKHRha2VVbnRpbCh0aGlzLl9kZXN0cm95JCkpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKHtcbiAgICAgICAgICAgICAgICBuZXh0OiBjYlxuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIF9hcHBseUNoYW5nZXMoKSB7XG4gICAgICAgIHRoaXMuX2NoYW5nZURldGVjdG9yUmVmLm1hcmtGb3JDaGVjaygpO1xuICAgICAgICB0aGlzLl9jaGFuZ2VEZXRlY3RvclJlZi5kZXRlY3RDaGFuZ2VzKCk7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIF9jaGVja0V4aXN0aW5nKGtleTogc3RyaW5nLCBuZXdWYWx1ZTogc3RyaW5nIHwgbnVtYmVyIHwgYm9vbGVhbiB8IE5neEZsb2F0VWlQbGFjZW1lbnRzKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLl9jb250ZW50KSB7XG4gICAgICAgICAgICB0aGlzLl9jb250ZW50LmZsb2F0VWlPcHRpb25zW2tleV0gPSBuZXdWYWx1ZTtcbiAgICAgICAgICAgIGlmICghdGhpcy5fc2hvd24pIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9jb250ZW50LnVwZGF0ZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIF9jb25zdHJ1Y3RDb250ZW50KCk6IE5neEZsb2F0VWlDb250ZW50Q29tcG9uZW50IHtcbiAgICAgICAgdGhpcy5fY29udGVudFJlZiA9IHRoaXMuX3Zjci5jcmVhdGVDb21wb25lbnQodGhpcy5fY29udGVudENsYXNzKTtcblxuICAgICAgICByZXR1cm4gdGhpcy5fY29udGVudFJlZi5pbnN0YW5jZSBhcyBOZ3hGbG9hdFVpQ29udGVudENvbXBvbmVudDtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgX2dldFNjcm9sbFBhcmVudChub2RlKSB7XG4gICAgICAgIGNvbnN0IGlzRWxlbWVudCA9IG5vZGUgaW5zdGFuY2VvZiBIVE1MRWxlbWVudDtcbiAgICAgICAgY29uc3Qgb3ZlcmZsb3dZID0gaXNFbGVtZW50ICYmIHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKG5vZGUpLm92ZXJmbG93WTtcbiAgICAgICAgY29uc3QgaXNTY3JvbGxhYmxlID0gb3ZlcmZsb3dZICE9PSBcInZpc2libGVcIiAmJiBvdmVyZmxvd1kgIT09IFwiaGlkZGVuXCI7XG5cbiAgICAgICAgaWYgKCFub2RlKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChpc1Njcm9sbGFibGUgJiYgbm9kZS5zY3JvbGxIZWlnaHQgPiBub2RlLmNsaWVudEhlaWdodCkge1xuICAgICAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcy5fZ2V0U2Nyb2xsUGFyZW50KG5vZGUucGFyZW50Tm9kZSkgfHwgZG9jdW1lbnQ7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIF9vblBvcHBlclVwZGF0ZSgpIHtcbiAgICAgICAgdGhpcy5vblVwZGF0ZS5lbWl0KCk7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIF9zZXRDb250ZW50UHJvcGVydGllcyhwb3BwZXJSZWY6IE5neEZsb2F0VWlDb250ZW50Q29tcG9uZW50KSB7XG4gICAgICAgIHBvcHBlclJlZi5mbG9hdFVpT3B0aW9ucyA9IE5neEZsb2F0VWlEaXJlY3RpdmUuYXNzaWduRGVmaW5lZChwb3BwZXJSZWYuZmxvYXRVaU9wdGlvbnMsIE5neEZsb2F0VWlEaXJlY3RpdmUuYmFzZU9wdGlvbnMsIHtcbiAgICAgICAgICAgIHNob3dEZWxheTogdGhpcy5zaG93RGVsYXksXG4gICAgICAgICAgICBkaXNhYmxlQW5pbWF0aW9uOiB0aGlzLmRpc2FibGVBbmltYXRpb24sXG4gICAgICAgICAgICBkaXNhYmxlRGVmYXVsdFN0eWxpbmc6IHRoaXMuZGlzYWJsZVN0eWxlLFxuICAgICAgICAgICAgcGxhY2VtZW50OiB0aGlzLnBsYWNlbWVudCxcbiAgICAgICAgICAgIGJvdW5kYXJpZXNFbGVtZW50OiB0aGlzLmJvdW5kYXJpZXNFbGVtZW50LFxuICAgICAgICAgICAgdHJpZ2dlcjogdGhpcy5zaG93VHJpZ2dlcixcbiAgICAgICAgICAgIHBvc2l0aW9uRml4ZWQ6IHRoaXMucG9zaXRpb25GaXhlZCxcbiAgICAgICAgICAgIGFyaWFEZXNjcmliZTogdGhpcy5hcmlhRGVzY3JpYmUsXG4gICAgICAgICAgICBhcmlhUm9sZTogdGhpcy5hcmlhUm9sZSxcbiAgICAgICAgICAgIGFwcGx5Q2xhc3M6IHRoaXMuYXBwbHlDbGFzcyxcbiAgICAgICAgICAgIGFwcGx5QXJyb3dDbGFzczogdGhpcy5hcnJvd0NsYXNzLFxuICAgICAgICAgICAgaGlkZU9uTW91c2VMZWF2ZTogdGhpcy5oaWRlT25Nb3VzZUxlYXZlLFxuICAgICAgICAgICAgc3R5bGVzOiB0aGlzLnN0eWxlcyxcbiAgICAgICAgICAgIGFwcGVuZFRvOiB0aGlzLmFwcGVuZFRvLFxuICAgICAgICAgICAgcHJldmVudE92ZXJmbG93OiB0aGlzLnByZXZlbnRPdmVyZmxvdyxcbiAgICAgICAgfSk7XG4gICAgICAgIHBvcHBlclJlZi5vblVwZGF0ZSA9IHRoaXMuX29uUG9wcGVyVXBkYXRlLmJpbmQodGhpcyk7XG4gICAgICAgIHBvcHBlclJlZi5vbkhpZGRlblxuICAgICAgICAgICAgLnBpcGUodGFrZVVudGlsKHRoaXMuX2Rlc3Ryb3kkKSlcbiAgICAgICAgICAgIC5zdWJzY3JpYmUodGhpcy5oaWRlLmJpbmQodGhpcykpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBfc2V0RGVmYXVsdHMoKSB7XG4gICAgICAgIFtcInNob3dEZWxheVwiLCBcImhpZGVPblNjcm9sbFwiLCBcImhpZGVPbk1vdXNlTGVhdmVcIiwgXCJoaWRlT25DbGlja091dHNpZGVcIiwgXCJhcmlhUm9sZVwiLCBcImFyaWFEZXNjcmliZVwiXS5mb3JFYWNoKChrZXkpID0+IHtcbiAgICAgICAgICAgIHRoaXNba2V5XSA9IHRoaXNba2V5XSA9PT0gdm9pZCAwID8gTmd4RmxvYXRVaURpcmVjdGl2ZS5iYXNlT3B0aW9uc1trZXldIDogdGhpc1trZXldO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zaG93VHJpZ2dlciA9IHRoaXMuc2hvd1RyaWdnZXIgfHwgTmd4RmxvYXRVaURpcmVjdGl2ZS5iYXNlT3B0aW9ucy50cmlnZ2VyO1xuICAgICAgICB0aGlzLnN0eWxlcyA9IHRoaXMuc3R5bGVzID09PSB2b2lkIDAgPyB7Li4uTmd4RmxvYXRVaURpcmVjdGl2ZS5iYXNlT3B0aW9ucy5zdHlsZXN9IDogdGhpcy5zdHlsZXM7XG4gICAgfVxuXG59XG4iXX0=